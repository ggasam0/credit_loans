{
  "input_csv": "output\\bert_standalone\\data\\bert_subset_processed.csv",
  "source_rows": 7108,
  "train_pos_cap": null,
  "sampling_strategy": "stratified_random_split",
  "sampled_class_counts": {
    "0": 4620,
    "1": 2488
  },
  "train_rows": 5686,
  "train_fit_rows": 4548,
  "validation_rows": 1138,
  "test_rows": 1422,
  "split_mode": "stratified_random_split",
  "train_sampling_summary": {
    "mode": "stratified_random_split",
    "test_size": 0.2,
    "val_size_within_train": 0.2,
    "random_state": 42,
    "max_attempts": 200,
    "attempts_used": 1,
    "selected_seed": 42,
    "rate_tolerance": 0.01,
    "rate_match_satisfied": true,
    "best_max_gap_vs_full": 0.0002917576967164104,
    "best_max_pair_gap": 0.0004745908507782781,
    "full": {
      "rows": 7108,
      "positive_rate": 0.35002813731007315,
      "class_counts": {
        "0": 4620,
        "1": 2488
      }
    },
    "train_fit": {
      "rows": 4548,
      "positive_rate": 0.3500439753737907,
      "class_counts": {
        "0": 2956,
        "1": 1592
      }
    },
    "validation": {
      "rows": 1138,
      "positive_rate": 0.34973637961335674,
      "class_counts": {
        "0": 740,
        "1": 398
      }
    },
    "test": {
      "rows": 1422,
      "positive_rate": 0.350210970464135,
      "class_counts": {
        "0": 924,
        "1": 498
      }
    },
    "shared_split_dir": "data\\shared\\splits\\stratified",
    "shared_row_id_col": "_shared_row_id"
  },
  "threshold_tuning": {
    "method": "validation_search",
    "threshold_policy": "fixed_reject_rate",
    "metric": "fixed_reject_rate_quantile",
    "precision_floor": null,
    "recall_floor": null,
    "min_reject_rate": null,
    "max_reject_rate": null,
    "target_reject_rate": 0.35,
    "constraint_satisfied": true,
    "fallback_metric": null,
    "best_threshold": 0.342026424407959,
    "best_score": NaN,
    "validation_precision": 0.4045226130653266,
    "validation_recall": 0.4045226130653266,
    "validation_reject_rate": 0.34973637961335674,
    "validation_metrics_at_best_threshold": {
      "accuracy": 0.5834797891036907,
      "precision": 0.4045226130653266,
      "recall": 0.4045226130653266,
      "f1": 0.4045226130653266,
      "balanced_accuracy": 0.5421261713975282,
      "pr_auc": 0.4116301946620886,
      "roc_auc": 0.5691531984245553
    },
    "validation_business_metrics_at_best_threshold": {
      "tp": 161.0,
      "fp": 237.0,
      "tn": 503.0,
      "fn": 237.0,
      "reject_rate": 0.34973637961335674,
      "approve_rate": 0.6502636203866432,
      "default_capture_recall": 0.4045226130653266,
      "bad_rate_in_reject_precision": 0.4045226130653266,
      "bad_rate_in_approve": 0.3202702702702703
    },
    "validation_fixed_metrics_at_target_reject_rate": {
      "threshold": 0.342026424407959,
      "target_reject_rate": 0.35,
      "actual_reject_rate": 0.34973637961335674,
      "precision_at_target_reject_rate": 0.4045226130653266,
      "recall_at_target_reject_rate": 0.4045226130653266,
      "approval_bad_rate": 0.3202702702702703,
      "lift_at_target_reject_rate": 1.1557788944723617,
      "classification_metrics": {
        "accuracy": 0.5834797891036907,
        "precision": 0.4045226130653266,
        "recall": 0.4045226130653266,
        "f1": 0.4045226130653266,
        "balanced_accuracy": 0.5421261713975282,
        "pr_auc": 0.4116301946620886,
        "roc_auc": 0.5691531984245553
      },
      "business_metrics": {
        "tp": 161.0,
        "fp": 237.0,
        "tn": 503.0,
        "fn": 237.0,
        "reject_rate": 0.34973637961335674,
        "approve_rate": 0.6502636203866432,
        "default_capture_recall": 0.4045226130653266,
        "bad_rate_in_reject_precision": 0.4045226130653266,
        "bad_rate_in_approve": 0.3202702702702703
      }
    }
  },
  "test_balance_enabled": false,
  "test_balance_summary": null,
  "bert_input_column": "bert_input",
  "requested_max_length": 514,
  "effective_max_length": 512,
  "tokenizer_max_length": 512,
  "base_model_path": "models\\bce-embedding-base_v1",
  "finetuned_model_dir": "output\\bert_standalone\\finetune_eval\\finetuned_model",
  "train_runtime_sec": 1306.3446,
  "eval_metrics_trainer": {
    "eval_loss": 0.6425850987434387,
    "eval_accuracy": 0.6502636203866432,
    "eval_precision": 0.0,
    "eval_recall": 0.0,
    "eval_f1": 0.0,
    "eval_balanced_accuracy": 0.5,
    "eval_pr_auc": 0.4116301946620886,
    "eval_roc_auc": 0.5691531984245553,
    "eval_runtime": 116.0385,
    "eval_samples_per_second": 9.807,
    "eval_steps_per_second": 0.62,
    "epoch": 1.0
  },
  "test_metrics": {
    "accuracy": 0.5639943741209564,
    "precision": 0.3894927536231884,
    "recall": 0.43172690763052207,
    "f1": 0.4095238095238095,
    "balanced_accuracy": 0.5335041464559537,
    "pr_auc": 0.3866181249876562,
    "roc_auc": 0.5580166988299519
  },
  "test_business_metrics": {
    "tp": 215.0,
    "fp": 337.0,
    "tn": 587.0,
    "fn": 283.0,
    "reject_rate": 0.3881856540084388,
    "approve_rate": 0.6118143459915611,
    "default_capture_recall": 0.43172690763052207,
    "bad_rate_in_reject_precision": 0.3894927536231884,
    "bad_rate_in_approve": 0.3252873563218391
  },
  "test_fixed_metrics_at_target_reject_rate": {
    "threshold": 0.342026424407959,
    "target_reject_rate": 0.35,
    "actual_reject_rate": 0.3881856540084388,
    "precision_at_target_reject_rate": 0.3894927536231884,
    "recall_at_target_reject_rate": 0.43172690763052207,
    "approval_bad_rate": 0.3252873563218391,
    "lift_at_target_reject_rate": 1.1128364389233956,
    "classification_metrics": {
      "accuracy": 0.5639943741209564,
      "precision": 0.3894927536231884,
      "recall": 0.43172690763052207,
      "f1": 0.4095238095238095,
      "balanced_accuracy": 0.5335041464559537,
      "pr_auc": 0.3866181249876562,
      "roc_auc": 0.5580166988299519
    },
    "business_metrics": {
      "tp": 215.0,
      "fp": 337.0,
      "tn": 587.0,
      "fn": 283.0,
      "reject_rate": 0.3881856540084388,
      "approve_rate": 0.6118143459915611,
      "default_capture_recall": 0.43172690763052207,
      "bad_rate_in_reject_precision": 0.3894927536231884,
      "bad_rate_in_approve": 0.3252873563218391
    }
  },
  "predictions_csv": "output\\bert_standalone\\finetune_eval\\bert_finetune_eval_predictions.csv",
  "gains_lift_curve_csv": "output\\bert_standalone\\finetune_eval\\bert_finetune_gains_lift_curve.csv"
}